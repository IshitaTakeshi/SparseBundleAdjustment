
calcImgProjJacRTS(Kparms, pr0, aj, aj+3, bi, (double (*)[6])Aij, (double (*)[3])Bij);

    t9 = sqrt(1.0-v[0]*v[0]-v[1]*v[1]-v[2]*v[2]);

    t12 = qr0[1] / t9;
    t19 = qr0[2] / t9;
    t25 = qr0[3] / t9;
    t54 = qr0[0] / t9;

    t15 = -t12*v[0] + qr0[0];
    t22 = -t19*v[0] - qr0[3];
    t27 = -t25*v[0] + qr0[2];

    t30 = -t15*M[0] - t22*M[1] - t27*M[2];
    t51 =  t35*M[0] - t43*M[1] - t49*M[2];

    t35 = -t9*qr0[1] - v[0]*qr0[0] - v[1]*qr0[3] + v[2]*qr0[2];
    t43 =  t9*qr0[2] + v[1]*qr0[0] + v[2]*qr0[1] - v[0]*qr0[3];
    t49 =  t9*qr0[3] + v[2]*qr0[0] + v[0]*qr0[2] - v[1]*qr0[1];
    t61 =  t9*qr0[0] - v[0]*qr0[1] - v[1]*qr0[2] - v[2]*qr0[3];

    t56 = -t54*v[0] - qr0[1];

    t65 = t61*M[0] + t43*M[2] - t49*M[1];
    t70 = t56*M[0] + t22*M[2] - t27*M[1];
    t75 = t56*M[1] + t27*M[0] - t15*M[2];
    t81 = t61*M[1] + t49*M[0] + t35*M[2];
    t87 = t56*M[2] + t15*M[1] - t22*M[0];
    t93 = t61*M[2] - t35*M[1] - t43*M[0];

    t107 = -t30*t43 - t22*t51 + t56*t81 + t61*t75 + t87*t35 - t93*t15 + t70*t49 + t27*t65;
    t118 = -t30*t49 - t27*t51 + t56*t93 + t61*t87 - t70*t43 - t65*t22 - t35*t75 + t81*t15;
    t143 =  t30*t35 - t15*t51 + t56*t65 + t61*t70 - t49*t75 - t81*t27 + t43*t87 + t93*t22;

    t126 = -t49*t51 + t61*t93 - t65*t43 - t81*t35 + t[2];
    t141 = -t51*t43 + t61*t81 + t93*t35 + t65*t49 + t[1];
    t132 =  t35*t51 + t61*t65 - t81*t49 + t93*t43 + t[0];

    t162 = -t12*v[1] + qr0[3];
    t165 = -t19*v[1] + qr0[0];
    t168 = -t25*v[1] - qr0[1];
    t175 = -t54*v[1] - qr0[2];

    t170 = -t162*M[0] - t165*M[1] - t168*M[2];
    t180 =  t175*M[0] + t165*M[2] - t168*M[1];
    t185 =  t175*M[1] + t168*M[0] - t162*M[2];
    t192 =  t175*M[2] + t162*M[1] - t165*M[0];

    t206 = -t170*t43 + t61*t185 + t175*t81 + t180*t49 - t93*t162 + t192*t35 + t65*t168 - t51*t165;
    t216 = -t170*t49 - t51*t168 + t175*t93 + t61*t192 - t180*t43 + t81*t162 - t185*t35 - t65*t165;
    t218 =  t170*t35 - t51*t162 + t175*t65 + t61*t180 + t192*t43 - t185*t49 - t81*t168 + t93*t165;

    t227 = -t12*v[2] - qr0[2];
    t230 = -t19*v[2] + qr0[1];
    t233 = -t25*v[2] + qr0[0];
    t240 = -t54*v[2] - qr0[3];

    t235 = -t227*M[0] - t230*M[1] - t233*M[2];
    t245 =  t240*M[0] + t230*M[2] - t233*M[1];
    t250 =  t240*M[1] + t233*M[0] - t227*M[2];
    t257 =  t240*M[2] + t227*M[1] - t230*M[0];

    t271 = -t235*t43 - t230*t51 + t240*t81 + t250*t61 + t257*t35 + t245*t49 - t227*t93 + t65*t233;
    t281 = -t235*t49 - t233*t51 + t240*t93 + t257*t61 - t245*t43 - t250*t35 - t230*t65 + t81*t227;
    t291 =  t235*t35 - t227*t51 + t240*t65 + t245*t61 - t250*t49 + t257*t43 - t233*t81 + t93*t230;

    t147 = (a[0]*t132 + t141*a[4] + t126*a[1]) / (t126*t126);
    t159 = (a[0]*a[3]*t141 + t126*a[2]) / (t126*t126);

    jacmRT[0][0] = (a[0]*t143 + a[4]*t107 + a[1]*t118) / t126 - t147*t118;
    jacmRT[0][1] = (a[0]*t218 + a[4]*t206 + a[1]*t216) / t126 - t147*t216;
    jacmRT[0][2] = (a[0]*t291 + a[4]*t271 + a[1]*t281) / t126 - t147*t281;

    jacmRT[1][0] = (a[0]*a[3]*t107 + a[2]*t118) / t126 - t159*t118;
    jacmRT[1][1] = (a[0]*a[3]*t206 + a[2]*t216) / t126 - t159*t216;
    jacmRT[1][2] = (a[0]*a[3]*t271 + a[2]*t281) / t126 - t159*t281;

    jacmRT[0][3] = a[0] / t126;
    jacmRT[1][3] = 0.0;
    jacmRT[0][4] = a[4] / t126;
    jacmRT[1][4] = a[0] * a[3] / t126;
    jacmRT[0][5] = a[1] / t126 - t147;
    jacmRT[1][5] = a[2] / t126 - t159;

    t303 =  2.0 * (t61*t49 - t35*t43);
    t309 = -2.0 * (t61*t43 + t49*t35);
    t331 =  2.0 * (t49*t43 - t61*t35);
    t342 = -2.0 * (t61*t49 + t35*t43);
    t347 =  2.0 * (t61*t35 + t43*t49);
    t353 =  2.0 * (t61*t43 - t35*t49);

    t350 = t49*t49 + t61*t61 - t43*t43 - t35*t35;
    t325 = t43*t43 + t61*t61 - t35*t35 - t49*t49;
    t301 = t35*t35 + t61*t61 - t49*t49 - t43*t43;

    jacmS[0][0] = (a[0]*t301 + a[4]*t303 + a[1]*t309) / t126 - t147*t309;
    jacmS[0][1] = (a[0]*t342 + a[4]*t325 + a[1]*t331) / t126 - t147*t331;
    jacmS[0][2] = (a[0]*t353 + a[4]*t347 + a[1]*t350) / t126 - t147*t350;

    jacmS[1][0] = (a[0]*a[3]*t303 + a[2]*t309) / t126 - t159*t309;
    jacmS[1][1] = (a[0]*a[3]*t325 + a[2]*t331) / t126 - t159*t331;
    jacmS[1][2] = (a[0]*a[3]*t347 + a[2]*t350) / t126 - t159*t350;
